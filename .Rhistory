raster::extent(apply(cbind(as.vector(extent(tt)),seed_extent),1,max,na.rm=T))
seed_extent <- c(2000000,rep(NA,3))
raster::extent(apply(cbind(as.vector(extent(tt)),seed_extent),1,max,na.rm=T))
?raster::"merge,Extent,ANY-method"
?raster::merge
my.ext
tt
extent(tt)
merge(extent(tt),my_ext)
merge(extent(tt),my.ext)
my.ext
?raster::intersect
intersect(extent(tt),my.ext)
my.ext[1]
is.na(seed_extent)
seed_extent
seed_extent[is.na(seed_extent)] <- extent(seeds)[is.na(seed_extent)]
seeds<-tt
seed_extent[is.na(seed_extent)] <- extent(seeds)[is.na(seed_extent)]
seed_extent[is.na(seed_extent)] <- as.vector(extent(seeds))[is.na(seed_extent)]
seed_extent
seed_extent <- raster::intersect(raster::extent(seed_extent), extent(seeds))
seed_extent
extent(seeds)
seed_extent <- c(2e+06,NA,NA,NA)
seed_extent
raster::extent(seed_extent)
seed_extent[is.na(seed_extent)] <- as.vector(extent(seeds))[is.na(seed_extent)]
seed_extent
raster::extent(seed_extent)
raster::intersect(raster::extent(seed_extent), extent(seeds))
seed_extent <- c(2e+05,NA,NA,NA)
seed_extent[is.na(seed_extent)] <- as.vector(extent(seeds))[is.na(seed_extent)]
raster::intersect(raster::extent(seed_extent), extent(seeds))
extent(seeds)
library(CanHeMonR)
extent(seeds)
as.vector(extent(seeds))
library(CanHeMonR)
pack <- "CanHeMonR"
path <- find.package(pack)
system(paste(shQuote(file.path(R.home("bin"), "R")),
"CMD", "Rd2pdf", shQuote(path)))
file.path(R.home("bin")
file.path(R.home("bin"), "R")
paste(shQuote(file.path(R.home("bin"), "R")),
+              "CMD", "Rd2pdf", shQuote(path))
paste(shQuote(file.path(R.home("bin"), "R")),
"CMD", "Rd2pdf", shQuote(path))
getwd()
shQuote(path)
?shQuote
path
cat(shQuote(test), "\n")
test <- "abc$def`gh`i\\j"
cat(shQuote(test), "\n")
paste(shQuote(file.path(R.home("bin"), "R")),
"CMD", "Rd2pdf", shQuote(path))
system("C:/PROGRA~1/R/R-32~1.2/bin/x64/" CMD Rd2pdf "E:/beckpie/Documents/R/win-library/3.2/CanHeMonR/")
system("R CMD Rd2pdf.")
getwd()
system("R CMD Rd2pdf .")
setwd('E://beckpie/Documents/R/win-library/3.2/CanHeMonR/')
getwd()
system("R CMD Rd2pdf .")
getwd()
system("R CMD Rd2pdf .")
system("R CMD Rd2pdf --force --output=./DocumentationPeek.pdf ." )
116+1+75
192/4
190*1480
784/115
7*250
49000/400
library(CanHeMonR)
library(CanHeMonR)
file.copy(from = 'E:/beckpie/temp/testjpegs/xx.sdf', to = 'E:/beckpie/temp/testjpegs/afsda.df')
?file.copy
?crown_inspector
rejects <- c(2,5,6,8,13,14,18,20,23,25,31,32,33,34,35,36,37,40,42,45,46,47,49,50,54,55,56,57,63,67,70,78,82,84,86,
87,89,92,97,100,103,106,107,108,109,110,112,115,117,126,127,131,133,135,136,137,138,142,145,147,148,151,154,156,157,
159,161,162,163,165,166,167,168,169,175,178,179,180,183,186,190,191,195,198,200,
201,206,210,211,212,213,214,215,218,219,221,223,224,236,237,238,239,241,242,243,244,246,248,250,251,254,255,258,259,263,266,
272,273,275,276,279,282,284,285,286,288,292,293,294,295,296,298,299,303,304,305,306,311,313,314,315,316,317,321,325,326,327,
329,331,332,333,334,335,338,340,341,343,347,348,349,352,353,354,355,356,357,358,360,364,365,366,367,369,370,371,372,373,376,
379,380,382,384,385,387,388,391,393,395,397,398,400,401,408,409,410,411,415,416,417,418,419,420,421,422,423,428,429,430,432,
433,434,435,436,439,440,441,442,443,444,445,446,449,451,452,453,454,456,458,459,460,462,463,466,467,469,472,474,475,476,478,
481,486,487,489,491,492,494,495,498,500)
#enter the numbers to be rejected (for the _part2 sample)
#move these to the rejected subdirectory
outp_dir <- 'E:/beckpie/temp/testjpegs'
jpgs <- list.files(outp_dir, full.names = T)
jpg_nrs <- unlist(lapply(strsplit(basename(jpgs),"_"),function(x){x[2]}))
jpg_nrs
jpg_reject <- basename(jpgs)[is.element(jpg_nrs,as.character(rejects))]
file.copy(from = file.path(from = outp_dir,jpg_reject), to = file.path(paste0(outp_dir,"/rejects"),jpg_reject))
file.remove(file.path(from = outp_dir,jpg_reject))
library(CanHeMonR)
outp_shp <- 'E:/beckpie/temp/testsamp_final_v2.shp'
inp_shp <-  'E:/beckpie/temp/testsamp_part2.shp'
inp_shp <-  'E:/beckpie/temp/testsamp_part2.shp'
outp_shp <- 'E:/beckpie/temp/testsamp_final_part2.shp'
inp_sample <- raster::shapefile(inp_shp)
rejects <- c(2,5,6,8,13,14,18,20,23,25,31,32,33,34,35,36,37,40,42,45,46,47,49,50,54,55,56,57,63,67,70,78,82,84,86,
87,89,92,97,100,103,106,107,108,109,110,112,115,117,126,127,131,133,135,136,137,138,142,145,147,148,151,154,156,157,
159,161,162,163,165,166,167,168,169,175,178,179,180,183,186,190,191,195,198,200,
201,206,210,211,212,213,214,215,218,219,221,223,224,236,237,238,239,241,242,243,244,246,248,250,251,254,255,258,259,263,266,
272,273,275,276,279,282,284,285,286,288,292,293,294,295,296,298,299,303,304,305,306,311,313,314,315,316,317,321,325,326,327,
329,331,332,333,334,335,338,340,341,343,347,348,349,352,353,354,355,356,357,358,360,364,365,366,367,369,370,371,372,373,376,
379,380,382,384,385,387,388,391,393,395,397,398,400,401,408,409,410,411,415,416,417,418,419,420,421,422,423,428,429,430,432,
433,434,435,436,439,440,441,442,443,444,445,446,449,451,452,453,454,456,458,459,460,462,463,466,467,469,472,474,475,476,478,
481,486,487,489,491,492,494,495,498,500)
rejects <- rejects-200
rejects <- rejects[rejects > 0]
rejects
outp_sample <- inp_sample[-rejects,]
slot(outp_sample,"data") <- cbind.data.frame(nr = 1:length(outp_sample), slot(outp_sample,"data"))
outp_shp
raster::shapefile(outp_sample, filename = outp_shp, overwrite = T)
?duplicates
?duplicate
?unique
rejects <- c(2,5,6,8,13,14,18,20,23,25,31,32,33,34,35,36,37,40,42,45,46,47,49,50,54,55,56,57,63,67,70,78,82,84,86,
87,89,92,97,100,103,106,107,108,109,110,112,115,117,126,127,131,133,135,136,137,138,142,145,147,148,151,154,156,157,
159,161,162,163,165,166,167,168,169,175,178,179,180,183,186,190,191,195,198,200,
201,206,210,211,212,213,214,215,218,219,221,223,224,236,237,238,239,241,242,243,244,246,248,250,251,254,255,258,259,263,266,
272,273,275,276,279,282,284,285,286,288,292,293,294,295,296,298,299,303,304,305,306,311,313,314,315,316,317,321,325,326,327,
329,331,332,333,334,335,338,340,341,343,347,348,349,352,353,354,355,356,357,358,360,364,365,366,367,369,370,371,372,373,376,
379,380,382,384,385,387,388,391,393,395,397,398,400,401,408,409,410,411,415,416,417,418,419,420,421,422,423,428,429,430,432,
433,434,435,436,439,440,441,442,443,444,445,446,449,451,452,453,454,456,458,459,460,462,463,466,467,469,472,474,475,476,478,
481,486,487,489,491,492,494,495,498,500,
501,503,507,515,519,522,523,524,525,526,530,531,533,534,536,537,541,542,544,546,547,550,551,553,558,560,561,562,564,565,567,
568,569,570,571,572,573,577,578,579,581,583,584,585,586,588,590,592,593,594,597,598,599,600,601,605,606,607,608,609,611,612,
614,615,617,618,619,620,621,622,623,628,629,631,632,633,635,638,639,640,641,642,643,644,645,646,648,649,650,651,652,654,655,
656,658,659,660,661,662,663,664,666,667,668,671,672,673,674,676,677,678,680,681,682,685,687,688,689,690,691,692,693,694,695,696,
697,700,701,702,704,705,706,709,711,712,713,714,719,720,723,725,726,727,728,729,733,735,736,737,738,740,741,742,745,746,747,
751,754,756,757,758,759,760,762,763,764,765,766,773,778,779,781,782,783,784,786,788,790,791,792,793,795,797,800)
#enter the numbers to be rejected (for the _part2 sample)
#move these to the rejected subdirectory
outp_dir <- 'E:/beckpie/temp/testjpegs'
jpgs <- list.files(outp_dir, full.names = T)
jpg_nrs <- unlist(lapply(strsplit(basename(jpgs),"_"),function(x){x[2]}))
jpg_reject <- basename(jpgs)[is.element(jpg_nrs,as.character(rejects))]
file.copy(from = file.path(from = outp_dir,jpg_reject), to = file.path(paste0(outp_dir,"/rejects"),jpg_reject))
file.remove(file.path(from = outp_dir,jpg_reject))
rejects <- c(2,5,6,8,13,14,18,20,23,25,31,32,33,34,35,36,37,40,42,45,46,47,49,50,54,55,56,57,63,67,70,78,82,84,86,
87,89,92,97,100,103,106,107,108,109,110,112,115,117,126,127,131,133,135,136,137,138,142,145,147,148,151,154,156,157,
159,161,162,163,165,166,167,168,169,175,178,179,180,183,186,190,191,195,198,200,
201,206,210,211,212,213,214,215,218,219,221,223,224,236,237,238,239,241,242,243,244,246,248,250,251,254,255,258,259,263,266,
272,273,275,276,279,282,284,285,286,288,292,293,294,295,296,298,299,303,304,305,306,311,313,314,315,316,317,321,325,326,327,
329,331,332,333,334,335,338,340,341,343,347,348,349,352,353,354,355,356,357,358,360,364,365,366,367,369,370,371,372,373,376,
379,380,382,384,385,387,388,391,393,395,397,398,400,401,408,409,410,411,415,416,417,418,419,420,421,422,423,428,429,430,432,
433,434,435,436,439,440,441,442,443,444,445,446,449,451,452,453,454,456,458,459,460,462,463,466,467,469,472,474,475,476,478,
481,486,487,489,491,492,494,495,498,500,
501,503,507,515,519,522,523,524,525,526,530,531,533,534,536,537,541,542,544,546,547,550,551,553,558,560,561,562,564,565,567,
568,569,570,571,572,573,577,578,579,581,583,584,585,586,588,590,592,593,594,597,598,599,600,601,605,606,607,608,609,611,612,
614,615,617,618,619,620,621,622,623,628,629,631,632,633,635,638,639,640,641,642,643,644,645,646,648,649,650,651,652,654,655,
656,658,659,660,661,662,663,664,666,667,668,671,672,673,674,676,677,678,680,681,682,685,687,688,689,690,691,692,693,694,695,696,
697,700,701,702,704,705,706,709,711,712,713,714,719,720,723,725,726,727,728,729,733,735,736,737,738,740,741,742,745,746,747,
751,754,756,757,758,759,760,762,763,764,765,766,773,778,779,781,782,783,784,786,788,790,791,792,793,795,797,800)
inp_shp <-  'E:/beckpie/temp/testsamp_part3.shp'
outp_shp <- 'E:/beckpie/temp/testsamp_final_part3.shp'
inp_sample <- raster::shapefile(inp_shp)
rejects <- rejects - 500
rejects <- rejects[rejects > 0]
outp_sample <- inp_sample[-rejects,]
slot(outp_sample,"data") <- cbind.data.frame(nr = 1:length(outp_sample), slot(outp_sample,"data"))
outp_shp
raster::shapefile(outp_sample, filename = outp_shp, overwrite = T)
outp_shp1 <- 'E:/beckpie/temp/testsamp_final.shp'
outp_shp2 <- 'E:/beckpie/temp/testsamp_final_part2.shp'
outp_shp3 <- 'E:/beckpie/temp/testsamp_final_part3.shp'
#check for duplicates
outp1 <- raster::shapefile(outp_shp1)
outp2 <- raster::shapefile(outp_shp2)
outp3 <- raster::shapefile(outp_shp3)
outp12 <- maptools::spRbind(outp1, outp2)
outp123 <- maptools::spRbind(outp12, outp3)
dim(outp123)
tt <- unique(slot(outp123,"coords"))
dim(tt)
tt <- slot(outp123,"coords")
dim(tt)
tt_un <- unique(tt)
plot(tt)
plot(tt_un,col=2)
plot(tt)
points(tt_un,col=2)
?unique
duplicated(tt)
outp123 <- outp123[-duplicated(tt), ]
dim(outp123)
outp123_un <- outp123[!duplicated(tt), ]
!duplicated(tt)
dim(outp123_un)
str(outp123)
duplicated(c(1,1))
outp123_un <- outp123[!duplicated(tt), ]
subset(outp123,1)
subset(outp123,!duplicated(tt))
length(duplicated(tt))
length(outp123)
outp123 <- maptools::spRbind(outp12, outp3)
length(outp123)
outp123_un <- subset(outp123,!duplicated(tt))
plot(outp123_un)
dim(outp123_un)
outp_shp_final_fname <- 'E:/beckpie/temp/testsamp_final_new.shp'
raster::shapefile(outp123_un, outp_shp_final_fname)
head(outp123_un)
slot(outp123_un,"data")$nr
slot(outp123_un,"data")$nr <- 1:length(outp123_un)
slot(outp123_un,"data")$nr
outp_shp_final_fname <- 'E:/beckpie/temp/testsamp_final_new.shp'
raster::shapefile(outp123_un, outp_shp_final_fname)
raster::shapefile(outp123_un, outp_shp_final_fname,overwrite=T)
outp_tab  <- 'E:/beckpie/temp/testsamp_final_new.csv'
coordinates_for_table <- round(slot(outp123_un,"coords"))
colnames(coordinates_for_table) <- c('East_UTM29N_WGS84','North_UTM29N_WGS84')
labels_ <- as.numeric(slot(outp_sample,"data")[['nr']])
dat_for_table <- cbind.data.frame(label = labels_, coordinates_for_table)
labels_ <- as.numeric(slot(outp_shp_final_fname,"data")[['nr']])
labels_ <- as.numeric(slot(outp123_un,"data")[['nr']])
dat_for_table <- cbind.data.frame(label = labels_, coordinates_for_table)
write.csv(x = dat_for_table, file = outp_tab,row.names = F)
dim(dat_for_table)
library(CanHeMonR)
wd <- 'H:/FISE/forest/CanopyHealthMonitoring/PWN/flights_final'
#triplates of image name, crown name, and RGB plotting order
r_150727_mca <- '150727_mca/150727_mca.bsq'
mca_outp_150727_shp <- 'shp+stats/150727/150727_mca/crown_150727_mca_all_trees_99.shp'
RGB_150727_mca <- 3:1
r_141120_rgb_mosaic <- '141120_RGB_mosaic/141120_RGB_mosaic.bsq'
rgb_mosaic_141120_shp <- 'shp+stats/141120/141120_rgb/crown_141120_rgb_all_trees_99.shp'
RGB_141120_rgb_mosaic <- 3:1
r_150727_rgb <- '150727_rgb/150727_rgb.bsq'
rgb_mosaic_150727_shp <- 'shp+stats/150727/150727_rgb/crown_150727_rgb_all_trees_99.shp'
RGB_150727_rgb <- 3:1
r_150727_flir <- '150727_flir/150727_flir.bsq'
flir_outp_150727_shp  <- 'shp+stats/150727/150727_flir/crown_150727_flir_all_trees_99_tps.shp'
RGB_150727_flir <- rep(1,3)
r_150128_hyperspectral <- '150128_hyperspectral/150128_hyperspectral.bsq'
# use DUMMY crowns!
RGB_150128_hyperspectral <- c(36,43,22)
#+++++++++++++++++++++++++
#combine all the triplets
image_fnames <- file.path(wd,c(r_141120_rgb_mosaic, r_150727_rgb,r_150727_mca, r_150727_flir, r_150128_hyperspectral))
crown_fnames <- file.path(wd,c(rgb_mosaic_141120_shp,rgb_mosaic_150727_shp,mca_outp_150727_shp,
flir_outp_150727_shp,rgb_mosaic_141120_shp))
RGBseqs <- cbind(RGB_141120_rgb_mosaic, RGB_150727_rgb, RGB_150727_mca, RGB_150727_flir, RGB_150128_hyperspectral)
#+++++++++++++++++++++++++
#outp_shp <- 'E:/beckpie/temp/testsamp.shp'
outp_shp <-  'E:/beckpie/temp/testsamp_part2.shp'
outp_shp <-  'E:/beckpie/temp/testsamp_part3.shp'
outp_shp <-  'E:/beckpie/temp/testsamp_part4.shp'
spatial_points <- raster::shapefile(outp_shp)
spatial_points <- as(spatial_points, "SpatialPoints")
outp_dir <- 'E:/beckpie/temp/testjpegs'
#outp_dir <- 'E:/beckpie/temp/testjpegs_part2'
require(CanHeMonR)
crown_inspector(spatial_points = spatial_points,
image_fnames = image_fnames,
crown_fnames = crown_fnames ,
RGBseqs = RGBseqs,
outp_dir = outp_dir,
overwrite = F)
rejects <- c(2,5,6,8,13,14,18,20,23,25,31,32,33,34,35,36,37,40,42,45,46,47,49,50,54,55,56,57,63,67,70,78,82,84,86,
87,89,92,97,100,103,106,107,108,109,110,112,115,117,126,127,131,133,135,136,137,138,142,145,147,148,151,154,156,157,
159,161,162,163,165,166,167,168,169,175,178,179,180,183,186,190,191,195,198,200,
201,206,210,211,212,213,214,215,218,219,221,223,224,236,237,238,239,241,242,243,244,246,248,250,251,254,255,258,259,263,266,
272,273,275,276,279,282,284,285,286,288,292,293,294,295,296,298,299,303,304,305,306,311,313,314,315,316,317,321,325,326,327,
329,331,332,333,334,335,338,340,341,343,347,348,349,352,353,354,355,356,357,358,360,364,365,366,367,369,370,371,372,373,376,
379,380,382,384,385,387,388,391,393,395,397,398,400,401,408,409,410,411,415,416,417,418,419,420,421,422,423,428,429,430,432,
433,434,435,436,439,440,441,442,443,444,445,446,449,451,452,453,454,456,458,459,460,462,463,466,467,469,472,474,475,476,478,
481,486,487,489,491,492,494,495,498,500,
501,503,507,515,519,522,523,524,525,526,530,531,533,534,536,537,541,542,544,546,547,550,551,553,558,560,561,562,564,565,567,
568,569,570,571,572,573,577,578,579,581,583,584,585,586,588,590,592,593,594,597,598,599,600,601,605,606,607,608,609,611,612,
614,615,617,618,619,620,621,622,623,628,629,631,632,633,635,638,639,640,641,642,643,644,645,646,648,649,650,651,652,654,655,
656,658,659,660,661,662,663,664,666,667,668,671,672,673,674,676,677,678,680,681,682,685,687,688,689,690,691,692,693,694,695,696,
697,700,701,702,704,705,706,709,711,712,713,714,719,720,723,725,726,727,728,729,733,735,736,737,738,740,741,742,745,746,747,
751,754,756,757,758,759,760,762,763,764,765,766,773,778,779,781,782,783,784,786,788,790,791,792,793,795,797,800,
804,806,807,811,812,816,817,820,823,825,830,832,833,834,837,840,841,843,844,845,846,848,849,850,852,853,855,856,858,859,861,
862,864,867,871,873,874,875,879,881,883,886,888,889,891,894,897,900,901,902,904,906,909,910,911,912,913,915,916,922,924,925,
927,930,931,933,935,937,941,942,950,952,957,963,964,965,967,970,974,975,979,983,986,987,988,989,990,991,993,994,995,997,999,
1001,1003,1004,1005,1006,1007,1008,1010,1011,1015,1016,1017,1020,1021,1022,1027,1034,1036,1038,1039,1040,1044,1048,1049,1052,
1053,1056,1059,1061,1062,1066,1069,1074,1075,1078,1079,1080,1081,1083,1087,1089,1090,1091,1092,1097,1098,1100)
#enter the numbers to be rejected (for the _part2 sample)
#move these to the rejected subdirectory
outp_dir <- 'E:/beckpie/temp/testjpegs'
jpgs <- list.files(outp_dir, full.names = T)
jpg_nrs <- unlist(lapply(strsplit(basename(jpgs),"_"),function(x){x[2]}))
jpg_reject <- basename(jpgs)[is.element(jpg_nrs,as.character(rejects))]
file.copy(from = file.path(from = outp_dir,jpg_reject), to = file.path(paste0(outp_dir,"/rejects"),jpg_reject))
file.remove(file.path(from = outp_dir,jpg_reject))
inp_shp <-  'E:/beckpie/temp/testsamp_part4.shp'
outp_shp <- 'E:/beckpie/temp/testsamp_final_v4.shp'
inp_sample <- raster::shapefile(inp_shp)
outp_sample <- inp_sample[-rejects,]
slot(outp_sample,"data") <- cbind.data.frame(nr = 1:length(outp_sample), slot(outp_sample,"data"))
raster::shapefile(outp_sample, filename = outp_shp, overwrite = T)
rejects <- c(2,5,6,8,13,14,18,20,23,25,31,32,33,34,35,36,37,40,42,45,46,47,49,50,54,55,56,57,63,67,70,78,82,84,86,
87,89,92,97,100,103,106,107,108,109,110,112,115,117,126,127,131,133,135,136,137,138,142,145,147,148,151,154,156,157,
159,161,162,163,165,166,167,168,169,175,178,179,180,183,186,190,191,195,198,200,
201,206,210,211,212,213,214,215,218,219,221,223,224,236,237,238,239,241,242,243,244,246,248,250,251,254,255,258,259,263,266,
272,273,275,276,279,282,284,285,286,288,292,293,294,295,296,298,299,303,304,305,306,311,313,314,315,316,317,321,325,326,327,
329,331,332,333,334,335,338,340,341,343,347,348,349,352,353,354,355,356,357,358,360,364,365,366,367,369,370,371,372,373,376,
379,380,382,384,385,387,388,391,393,395,397,398,400,401,408,409,410,411,415,416,417,418,419,420,421,422,423,428,429,430,432,
433,434,435,436,439,440,441,442,443,444,445,446,449,451,452,453,454,456,458,459,460,462,463,466,467,469,472,474,475,476,478,
481,486,487,489,491,492,494,495,498,500,
501,503,507,515,519,522,523,524,525,526,530,531,533,534,536,537,541,542,544,546,547,550,551,553,558,560,561,562,564,565,567,
568,569,570,571,572,573,577,578,579,581,583,584,585,586,588,590,592,593,594,597,598,599,600,601,605,606,607,608,609,611,612,
614,615,617,618,619,620,621,622,623,628,629,631,632,633,635,638,639,640,641,642,643,644,645,646,648,649,650,651,652,654,655,
656,658,659,660,661,662,663,664,666,667,668,671,672,673,674,676,677,678,680,681,682,685,687,688,689,690,691,692,693,694,695,696,
697,700,701,702,704,705,706,709,711,712,713,714,719,720,723,725,726,727,728,729,733,735,736,737,738,740,741,742,745,746,747,
751,754,756,757,758,759,760,762,763,764,765,766,773,778,779,781,782,783,784,786,788,790,791,792,793,795,797,800,
804,806,807,811,812,816,817,820,823,825,830,832,833,834,837,840,841,843,844,845,846,848,849,850,852,853,855,856,858,859,861,
862,864,867,871,873,874,875,879,881,883,886,888,889,891,894,897,900,901,902,904,906,909,910,911,912,913,915,916,922,924,925,
927,930,931,933,935,937,941,942,950,952,957,963,964,965,967,970,974,975,979,983,986,987,988,989,990,991,993,994,995,997,999,
1001,1003,1004,1005,1006,1007,1008,1010,1011,1015,1016,1017,1020,1021,1022,1027,1034,1036,1038,1039,1040,1044,1048,1049,1052,
1053,1056,1059,1061,1062,1066,1069,1074,1075,1078,1079,1080,1081,1083,1087,1089,1090,1091,1092,1097,1098,1100)
inp_shp <-  'E:/beckpie/temp/testsamp_part4.shp'
outp_shp <- 'E:/beckpie/temp/testsamp_final_part4.shp'
inp_sample <- raster::shapefile(inp_shp)
rejects <- rejects-800
rejects <- rejects[rejects > 0]
outp_sample <- inp_sample[-rejects,]
slot(outp_sample,"data") <- cbind.data.frame(nr = 1:length(outp_sample), slot(outp_sample,"data"))
#save it as a .shp
raster::shapefile(outp_sample, filename = outp_shp, overwrite = T)
outp123
outp_shp4 <- 'E:/beckpie/temp/testsamp_final_part4.shp'
outp4 <- raster::shapefile(outp_shp4)
outp1234
outp4
366+160
outp124 <- maptools::spRbind(outp123, outp4)
outp1234 <- maptools::spRbind(outp123, outp4)
tt <- slot(outp1234,"coords")
outp1234_un <- subset(outp1234,!duplicated(tt))
outp1234_un
library(CanHeMonR)
library(CanHeMonR)
library(CanHeMonR)
library(CanHeMonR)
wd <- 'H:/FISE/forest/CanopyHealthMonitoring/PWN/flights_final'
#triplates of image name, crown name, and RGB plotting order
r_150727_mca <- '150727_mca/150727_mca.bsq'
mca_outp_150727_shp <- 'shp+stats/150727/150727_mca/crown_150727_mca_all_trees_99.shp'
RGB_150727_mca <- 3:1
r_141120_rgb_mosaic <- '141120_RGB_mosaic/141120_RGB_mosaic.bsq'
rgb_mosaic_141120_shp <- 'shp+stats/141120/141120_rgb/crown_141120_rgb_all_trees_99.shp'
RGB_141120_rgb_mosaic <- 3:1
r_150727_rgb <- '150727_rgb/150727_rgb.bsq'
rgb_mosaic_150727_shp <- 'shp+stats/150727/150727_rgb/crown_150727_rgb_all_trees_99.shp'
RGB_150727_rgb <- 3:1
r_150727_flir <- '150727_flir/150727_flir.bsq'
flir_outp_150727_shp  <- 'shp+stats/150727/150727_flir/crown_150727_flir_all_trees_99_tps.shp'
RGB_150727_flir <- rep(1,3)
r_150128_hyperspectral <- '150128_hyperspectral/150128_hyperspectral.bsq'
# use DUMMY crowns!
RGB_150128_hyperspectral <- c(36,43,22)
#+++++++++++++++++++++++++
#combine all the triplets
image_fnames <- file.path(wd,c(r_141120_rgb_mosaic, r_150727_rgb,r_150727_mca, r_150727_flir, r_150128_hyperspectral))
crown_fnames <- file.path(wd,c(rgb_mosaic_141120_shp,rgb_mosaic_150727_shp,mca_outp_150727_shp,
flir_outp_150727_shp,rgb_mosaic_141120_shp))
RGBseqs <- cbind(RGB_141120_rgb_mosaic, RGB_150727_rgb, RGB_150727_mca, RGB_150727_flir, RGB_150128_hyperspectral)
#+++++++++++++++++++++++++
#outp_shp <- 'E:/beckpie/temp/testsamp.shp'
outp_shp <-  'E:/beckpie/temp/testsamp_part2.shp'
outp_shp <-  'E:/beckpie/temp/testsamp_part3.shp'
outp_shp <-  'E:/beckpie/temp/testsamp_part4.shp'
outp_shp <-  'E:/beckpie/temp/testsamp_part5.shp'
spatial_points <- raster::shapefile(outp_shp)
spatial_points <- as(spatial_points, "SpatialPoints")
outp_dir <- 'E:/beckpie/temp/testjpegs'
#outp_dir <- 'E:/beckpie/temp/testjpegs_part2'
require(CanHeMonR)
crown_inspector(spatial_points = spatial_points,
image_fnames = image_fnames,
crown_fnames = crown_fnames ,
RGBseqs = RGBseqs,
outp_dir = outp_dir,
overwrite = F)
inp_shp <-  'E:/beckpie/temp/testsamp_part5.shp'
outp_shp <- 'E:/beckpie/temp/testsamp_final_part5.shp'
inp_sample <- raster::shapefile(inp_shp)
rejects <- rejects - 1100
rejects <- rejects[rejects > 0]
outp_sample <- inp_sample[-rejects,]
slot(outp_sample,"data") <- cbind.data.frame(nr = 1:length(outp_sample), slot(outp_sample,"data"))
#save it as a .shp
raster::shapefile(outp_sample, filename = outp_shp, overwrite = T)
length(rejects)
rejects <- c(2,5,6,8,13,14,18,20,23,25,31,32,33,34,35,36,37,40,42,45,46,47,49,50,54,55,56,57,63,67,70,78,82,84,86,
87,89,92,97,100,103,106,107,108,109,110,112,115,117,126,127,131,133,135,136,137,138,142,145,147,148,151,154,156,157,
159,161,162,163,165,166,167,168,169,175,178,179,180,183,186,190,191,195,198,200,
201,206,210,211,212,213,214,215,218,219,221,223,224,236,237,238,239,241,242,243,244,246,248,250,251,254,255,258,259,263,266,
272,273,275,276,279,282,284,285,286,288,292,293,294,295,296,298,299,303,304,305,306,311,313,314,315,316,317,321,325,326,327,
329,331,332,333,334,335,338,340,341,343,347,348,349,352,353,354,355,356,357,358,360,364,365,366,367,369,370,371,372,373,376,
379,380,382,384,385,387,388,391,393,395,397,398,400,401,408,409,410,411,415,416,417,418,419,420,421,422,423,428,429,430,432,
433,434,435,436,439,440,441,442,443,444,445,446,449,451,452,453,454,456,458,459,460,462,463,466,467,469,472,474,475,476,478,
481,486,487,489,491,492,494,495,498,500,
501,503,507,515,519,522,523,524,525,526,530,531,533,534,536,537,541,542,544,546,547,550,551,553,558,560,561,562,564,565,567,
568,569,570,571,572,573,577,578,579,581,583,584,585,586,588,590,592,593,594,597,598,599,600,601,605,606,607,608,609,611,612,
614,615,617,618,619,620,621,622,623,628,629,631,632,633,635,638,639,640,641,642,643,644,645,646,648,649,650,651,652,654,655,
656,658,659,660,661,662,663,664,666,667,668,671,672,673,674,676,677,678,680,681,682,685,687,688,689,690,691,692,693,694,695,696,
697,700,701,702,704,705,706,709,711,712,713,714,719,720,723,725,726,727,728,729,733,735,736,737,738,740,741,742,745,746,747,
751,754,756,757,758,759,760,762,763,764,765,766,773,778,779,781,782,783,784,786,788,790,791,792,793,795,797,800,
804,806,807,811,812,816,817,820,823,825,830,832,833,834,837,840,841,843,844,845,846,848,849,850,852,853,855,856,858,859,861,
862,864,867,871,873,874,875,879,881,883,886,888,889,891,894,897,900,901,902,904,906,909,910,911,912,913,915,916,922,924,925,
927,930,931,933,935,937,941,942,950,952,957,963,964,965,967,970,974,975,979,983,986,987,988,989,990,991,993,994,995,997,999,
1001,1003,1004,1005,1006,1007,1008,1010,1011,1015,1016,1017,1020,1021,1022,1027,1034,1036,1038,1039,1040,1044,1048,1049,1052,
1053,1056,1059,1061,1062,1066,1069,1074,1075,1078,1079,1080,1081,1083,1087,1089,1090,1091,1092,1097,1098,1100,
1102,1104,1106,1107,1111,1112,1114,1115,1119,1122,1124,1125,1127,1128,1129,1130,1132,1133,1137,1139,1140,1142,1145,1148,1149,
1150,1153,1160,1163,1164,1165,1166,1168,1169,1171,1173,1175,1177,1178,1181,1182,1183,1184,1187,1189,1190,1192,1193,1195,1196,
1199,1200)
inp_shp <-  'E:/beckpie/temp/testsamp_part5.shp'
outp_shp <- 'E:/beckpie/temp/testsamp_final_part5.shp'
inp_sample <- raster::shapefile(inp_shp)
rejects <- rejects - 1100
rejects <- rejects[rejects > 0]
outp_sample <- inp_sample[-rejects,]
slot(outp_sample,"data") <- cbind.data.frame(nr = 1:length(outp_sample), slot(outp_sample,"data"))
#save it as a .shp
raster::shapefile(outp_sample, filename = outp_shp, overwrite = T)
outp_shp5 <- 'E:/beckpie/temp/testsamp_final_part5.shp'
outp5 <- raster::shapefile(outp_shp5)
outp12345 <- maptools::spRbind(outp12345, outp5)
tt <- slot(outp12345,"coords")
outp12345_un
#move these to the rejected subdirectory
outp_dir <- 'E:/beckpie/temp/testjpegs'
jpgs <- list.files(outp_dir, full.names = T)
jpg_nrs <- unlist(lapply(strsplit(basename(jpgs),"_"),function(x){x[2]}))
jpg_reject <- basename(jpgs)[is.element(jpg_nrs,as.character(rejects))]
file.copy(from = file.path(from = outp_dir,jpg_reject), to = file.path(paste0(outp_dir,"/rejects"),jpg_reject))
file.remove(file.path(from = outp_dir,jpg_reject))
rejects
jpg_reject
file.copy(to = file.path(from = outp_dir,jpg_reject), from = file.path(paste0(outp_dir,"/rejects"),jpg_reject))
file.remove(file.path(from = file.path(paste0(outp_dir,"/rejects"),jpg_reject))
)
rejects <- c(2,5,6,8,13,14,18,20,23,25,31,32,33,34,35,36,37,40,42,45,46,47,49,50,54,55,56,57,63,67,70,78,82,84,86,
87,89,92,97,100,103,106,107,108,109,110,112,115,117,126,127,131,133,135,136,137,138,142,145,147,148,151,154,156,157,
159,161,162,163,165,166,167,168,169,175,178,179,180,183,186,190,191,195,198,200,
201,206,210,211,212,213,214,215,218,219,221,223,224,236,237,238,239,241,242,243,244,246,248,250,251,254,255,258,259,263,266,
272,273,275,276,279,282,284,285,286,288,292,293,294,295,296,298,299,303,304,305,306,311,313,314,315,316,317,321,325,326,327,
329,331,332,333,334,335,338,340,341,343,347,348,349,352,353,354,355,356,357,358,360,364,365,366,367,369,370,371,372,373,376,
379,380,382,384,385,387,388,391,393,395,397,398,400,401,408,409,410,411,415,416,417,418,419,420,421,422,423,428,429,430,432,
433,434,435,436,439,440,441,442,443,444,445,446,449,451,452,453,454,456,458,459,460,462,463,466,467,469,472,474,475,476,478,
481,486,487,489,491,492,494,495,498,500,
501,503,507,515,519,522,523,524,525,526,530,531,533,534,536,537,541,542,544,546,547,550,551,553,558,560,561,562,564,565,567,
568,569,570,571,572,573,577,578,579,581,583,584,585,586,588,590,592,593,594,597,598,599,600,601,605,606,607,608,609,611,612,
614,615,617,618,619,620,621,622,623,628,629,631,632,633,635,638,639,640,641,642,643,644,645,646,648,649,650,651,652,654,655,
656,658,659,660,661,662,663,664,666,667,668,671,672,673,674,676,677,678,680,681,682,685,687,688,689,690,691,692,693,694,695,696,
697,700,701,702,704,705,706,709,711,712,713,714,719,720,723,725,726,727,728,729,733,735,736,737,738,740,741,742,745,746,747,
751,754,756,757,758,759,760,762,763,764,765,766,773,778,779,781,782,783,784,786,788,790,791,792,793,795,797,800,
804,806,807,811,812,816,817,820,823,825,830,832,833,834,837,840,841,843,844,845,846,848,849,850,852,853,855,856,858,859,861,
862,864,867,871,873,874,875,879,881,883,886,888,889,891,894,897,900,901,902,904,906,909,910,911,912,913,915,916,922,924,925,
927,930,931,933,935,937,941,942,950,952,957,963,964,965,967,970,974,975,979,983,986,987,988,989,990,991,993,994,995,997,999,
1001,1003,1004,1005,1006,1007,1008,1010,1011,1015,1016,1017,1020,1021,1022,1027,1034,1036,1038,1039,1040,1044,1048,1049,1052,
1053,1056,1059,1061,1062,1066,1069,1074,1075,1078,1079,1080,1081,1083,1087,1089,1090,1091,1092,1097,1098,1100,
1102,1104,1106,1107,1111,1112,1114,1115,1119,1122,1124,1125,1127,1128,1129,1130,1132,1133,1137,1139,1140,1142,1145,1148,1149,
1150,1153,1160,1163,1164,1165,1166,1168,1169,1171,1173,1175,1177,1178,1181,1182,1183,1184,1187,1189,1190,1192,1193,1195,1196,
1199,1200)
#enter the numbers to be rejected (for the _part2 sample)
outp_dir <- 'E:/beckpie/temp/testjpegs'
jpgs <- list.files(outp_dir, full.names = T)
jpg_nrs <- unlist(lapply(strsplit(basename(jpgs),"_"),function(x){x[2]}))
jpg_reject <- basename(jpgs)[is.element(jpg_nrs,as.character(rejects))]
jpg_reject
file.copy(from = file.path(from = outp_dir,jpg_reject), to = file.path(paste0(outp_dir,"/rejects"),jpg_reject))
file.remove(file.path(from = outp_dir,jpg_reject))
outp12345 <- maptools::spRbind(outp1234, outp5)
outp12345
outp1234
tt <- slot(outp12345,"coords")
outp12345_un <- subset(outp12345,!duplicated(tt))
outp12345_un
slot(outp12345_un,"data")$nr <- 1:length(outp12345_un)
outp_shp_final_fname <- 'E:/beckpie/temp/testsamp_final_350.shp'
raster::shapefile(outp12345_un, outp_shp_final_fname,overwrite=T)
outp_tab  <- 'E:/beckpie/temp/testsamp_final_350.csv'
coordinates_for_table <- round(slot(outp123_un,"coords"))
coordinates_for_table <- round(slot(outp12345_un,"coords"))
colnames(coordinates_for_table) <- c('East_UTM29N_WGS84','North_UTM29N_WGS84')
labels_ <- as.numeric(slot(outp12345_un,"data")[['nr']])
dat_for_table <- cbind.data.frame(label = labels_, coordinates_for_table)
write.csv(x = dat_for_table, file = outp_tab,row.names = F)
outp_shp_final_fname <- 'H:/FISE/forest/CanopyHealthMonitoring/PWN/maps/Grandilla_2015_sampling/350/testsamp_final_350.shp'
raster::shapefile(outp12345_un, outp_shp_final_fname,overwrite=T)
library(CanHeMonR)
?raster::crop
?sp::over
library(CanHeMonR)
?exit
?return
library(CanHeMonR)
library(CanHeMonR)
?sp::over
library(CanHeMonR)
library(CanHeMonR)
library(CanHeMonR)
library(CanHeMonR)
?file.copy
library(CanHeMonR)
?grow.crowns
?grow_crowns
edit(grow_crowns)
?read.csv
library(CanHeMonR)
